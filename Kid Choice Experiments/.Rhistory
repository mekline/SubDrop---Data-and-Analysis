<td id="LC442" class="blob-code blob-code-inner js-file-line">conttable &lt;- conttable[conttable$Age.Years &gt; 2,]</td>
</tr>
<tr>
<td id="L443" class="blob-num js-line-number" data-line-number="443"></td>
<td id="LC443" class="blob-code blob-code-inner js-file-line">#Look at n kids in sub-experiments (this is good for checking updates on n subjects needed per condition)</td>
</tr>
<tr>
<td id="L444" class="blob-num js-line-number" data-line-number="444"></td>
<td id="LC444" class="blob-code blob-code-inner js-file-line">#How many kids of each Age, Experiment, Condition?</td>
</tr>
<tr>
<td id="L445" class="blob-num js-line-number" data-line-number="445"></td>
<td id="LC445" class="blob-code blob-code-inner js-file-line">with(maintable, tapply(as.numeric(as.character(Final.Include)), list(Condition, Age.Years), sum.na.rm), drop=TRUE)</td>
</tr>
<tr>
<td id="L446" class="blob-num js-line-number" data-line-number="446"></td>
<td id="LC446" class="blob-code blob-code-inner js-file-line">with(conttable, tapply(as.numeric(as.character(Final.Include)), list(Condition, Age.Years), sum.na.rm), drop=TRUE)</td>
</tr>
<tr>
<td id="L447" class="blob-num js-line-number" data-line-number="447"></td>
<td id="LC447" class="blob-code blob-code-inner js-file-line">#Make sure factors are coded correctly, and melt the dataset for logistic analyses</td>
</tr>
<tr>
<td id="L448" class="blob-num js-line-number" data-line-number="448"></td>
<td id="LC448" class="blob-code blob-code-inner js-file-line">maintable$Condition &lt;- as.factor(maintable$Condition)</td>
</tr>
<tr>
<td id="L449" class="blob-num js-line-number" data-line-number="449"></td>
<td id="LC449" class="blob-code blob-code-inner js-file-line">maintable$Subject &lt;- as.factor(maintable$Subject..)</td>
</tr>
<tr>
<td id="L450" class="blob-num js-line-number" data-line-number="450"></td>
<td id="LC450" class="blob-code blob-code-inner js-file-line">maintable$choseObjectDrop &lt;- as.factor(maintable$choseObjectDrop)</td>
</tr>
<tr>
<td id="L451" class="blob-num js-line-number" data-line-number="451"></td>
<td id="LC451" class="blob-code blob-code-inner js-file-line">maintable$pragChoice_1 &lt;- maintable$isPragChoiceA</td>
</tr>
<tr>
<td id="L452" class="blob-num js-line-number" data-line-number="452"></td>
<td id="LC452" class="blob-code blob-code-inner js-file-line">maintable$pragChoice_2 &lt;- maintable$isPragChoiceB</td>
</tr>
<tr>
<td id="L453" class="blob-num js-line-number" data-line-number="453"></td>
<td id="LC453" class="blob-code blob-code-inner js-file-line">#Get the objective coding scheme back :)</td>
</tr>
<tr>
<td id="L454" class="blob-num js-line-number" data-line-number="454"></td>
<td id="LC454" class="blob-code blob-code-inner js-file-line">main.long = wideToLong(maintable,within=&quot;trial&quot;, sep=&#39;_&#39;)</td>
</tr>
<tr>
<td id="L455" class="blob-num js-line-number" data-line-number="455"></td>
<td id="LC455" class="blob-code blob-code-inner js-file-line">main.long$choseObjectDrop &lt;- main.long$pragChoice</td>
</tr>
<tr>
<td id="L456" class="blob-num js-line-number" data-line-number="456"></td>
<td id="LC456" class="blob-code blob-code-inner js-file-line">main.long[main.long$Condition == &quot;SD&quot;,]$choseObjectDrop &lt;- 1-main.long[main.long$Condition == &quot;SD&quot;,]$pragChoice</td>
</tr>
<tr>
<td id="L457" class="blob-num js-line-number" data-line-number="457"></td>
<td id="LC457" class="blob-code blob-code-inner js-file-line">conttable$Condition &lt;- as.factor(conttable$Condition)</td>
</tr>
<tr>
<td id="L458" class="blob-num js-line-number" data-line-number="458"></td>
<td id="LC458" class="blob-code blob-code-inner js-file-line">conttable$Subject &lt;- as.factor(conttable$Subject..)</td>
</tr>
<tr>
<td id="L459" class="blob-num js-line-number" data-line-number="459"></td>
<td id="LC459" class="blob-code blob-code-inner js-file-line">conttable$choseObjectDrop &lt;- as.factor(conttable$choseObjectDrop)</td>
</tr>
<tr>
<td id="L460" class="blob-num js-line-number" data-line-number="460"></td>
<td id="LC460" class="blob-code blob-code-inner js-file-line">conttable$pragChoice_1 &lt;- conttable$isPragChoiceA</td>
</tr>
<tr>
<td id="L461" class="blob-num js-line-number" data-line-number="461"></td>
<td id="LC461" class="blob-code blob-code-inner js-file-line">conttable$pragChoice_2 &lt;- conttable$isPragChoiceB</td>
</tr>
<tr>
<td id="L462" class="blob-num js-line-number" data-line-number="462"></td>
<td id="LC462" class="blob-code blob-code-inner js-file-line">#Get the objective coding scheme back :)</td>
</tr>
<tr>
<td id="L463" class="blob-num js-line-number" data-line-number="463"></td>
<td id="LC463" class="blob-code blob-code-inner js-file-line">cont.long = wideToLong(conttable,within=&quot;trial&quot;, sep=&#39;_&#39;)</td>
</tr>
<tr>
<td id="L464" class="blob-num js-line-number" data-line-number="464"></td>
<td id="LC464" class="blob-code blob-code-inner js-file-line">cont.long$choseObjectDrop &lt;- cont.long$pragChoice</td>
</tr>
<tr>
<td id="L465" class="blob-num js-line-number" data-line-number="465"></td>
<td id="LC465" class="blob-code blob-code-inner js-file-line">cont.long[cont.long$Condition == &quot;SD&quot;,]$choseObjectDrop &lt;- 1-cont.long[cont.long$Condition == &quot;SD&quot;,]$pragChoice</td>
</tr>
<tr>
<td id="L466" class="blob-num js-line-number" data-line-number="466"></td>
<td id="LC466" class="blob-code blob-code-inner js-file-line">#For quick-and-dirty graphs</td>
</tr>
<tr>
<td id="L467" class="blob-num js-line-number" data-line-number="467"></td>
<td id="LC467" class="blob-code blob-code-inner js-file-line">table(maintable$Condition, maintable$choseObjectDrop)</td>
</tr>
<tr>
<td id="L468" class="blob-num js-line-number" data-line-number="468"></td>
<td id="LC468" class="blob-code blob-code-inner js-file-line">table(maintable$Age.Years, maintable$pragChoiceScore)</td>
</tr>
<tr>
<td id="L469" class="blob-num js-line-number" data-line-number="469"></td>
<td id="LC469" class="blob-code blob-code-inner js-file-line">table(conttable$Condition, conttable$pragChoiceScore)</td>
</tr>
<tr>
<td id="L470" class="blob-num js-line-number" data-line-number="470"></td>
<td id="LC470" class="blob-code blob-code-inner js-file-line">table(conttable$Age.Years, conttable$pragChoiceScore)</td>
</tr>
<tr>
<td id="L471" class="blob-num js-line-number" data-line-number="471"></td>
<td id="LC471" class="blob-code blob-code-inner js-file-line">####################################</td>
</tr>
<tr>
<td id="L472" class="blob-num js-line-number" data-line-number="472"></td>
<td id="LC472" class="blob-code blob-code-inner js-file-line"># Analysis!</td>
</tr>
<tr>
<td id="L473" class="blob-num js-line-number" data-line-number="473"></td>
<td id="LC473" class="blob-code blob-code-inner js-file-line">###</td>
</tr>
<tr>
<td id="L474" class="blob-num js-line-number" data-line-number="474"></td>
<td id="LC474" class="blob-code blob-code-inner js-file-line">#Question #1 - is choice of OD puppet sensitive to condition?</td>
</tr>
<tr>
<td id="L475" class="blob-num js-line-number" data-line-number="475"></td>
<td id="LC475" class="blob-code blob-code-inner js-file-line"># Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects</td>
</tr>
<tr>
<td id="L476" class="blob-num js-line-number" data-line-number="476"></td>
<td id="LC476" class="blob-code blob-code-inner js-file-line">full_maximal_model &lt;- lmer(choseObjectDrop ~ Condition + (Condition|trial) + (1|Subject), data=main.long, family=&quot;binomial&quot;)</td>
</tr>
<tr>
<td id="L477" class="blob-num js-line-number" data-line-number="477"></td>
<td id="LC477" class="blob-code blob-code-inner js-file-line">#compare to model w/o fixed effect</td>
</tr>
<tr>
<td id="L478" class="blob-num js-line-number" data-line-number="478"></td>
<td id="LC478" class="blob-code blob-code-inner js-file-line">no_fixed &lt;- lmer(choseObjectDrop ~ 1 + (Condition|trial) + (1|Subject), data=main.long, family=&quot;binomial&quot;)</td>
</tr>
<tr>
<td id="L479" class="blob-num js-line-number" data-line-number="479"></td>
<td id="LC479" class="blob-code blob-code-inner js-file-line">anova(full_maximal_model, no_fixed)</td>
</tr>
<tr>
<td id="L480" class="blob-num js-line-number" data-line-number="480"></td>
<td id="LC480" class="blob-code blob-code-inner js-file-line">#Answer #1 marginal (with all ages included)</td>
</tr>
<tr>
<td id="L481" class="blob-num js-line-number" data-line-number="481"></td>
<td id="LC481" class="blob-code blob-code-inner js-file-line">###</td>
</tr>
<tr>
<td id="L482" class="blob-num js-line-number" data-line-number="482"></td>
<td id="LC482" class="blob-code blob-code-inner js-file-line">#Question 2: Does age influence choice patterns?</td>
</tr>
<tr>
<td id="L483" class="blob-num js-line-number" data-line-number="483"></td>
<td id="LC483" class="blob-code blob-code-inner js-file-line">#Scale age (z score), to avoid convergence problems (this worked on some datasets)</td>
</tr>
<tr>
<td id="L484" class="blob-num js-line-number" data-line-number="484"></td>
<td id="LC484" class="blob-code blob-code-inner js-file-line">main.long$Scaled.Days.Old &lt;- scale(main.long$Days.Old)</td>
</tr>
<tr>
<td id="L485" class="blob-num js-line-number" data-line-number="485"></td>
<td id="LC485" class="blob-code blob-code-inner js-file-line"># Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects</td>
</tr>
<tr>
<td id="L486" class="blob-num js-line-number" data-line-number="486"></td>
<td id="LC486" class="blob-code blob-code-inner js-file-line">full_maximal_age_model &lt;- lmer(choseObjectDrop ~ Condition*Scaled.Days.Old + (Condition|trial) + (1|Subject), data=main.long, family=&quot;binomial&quot;)</td>
</tr>
<tr>
<td id="L487" class="blob-num js-line-number" data-line-number="487"></td>
<td id="LC487" class="blob-code blob-code-inner js-file-line">#If that doesn&#39;t converge, as it doesn&#39;t as of 10/10, remove random effects...</td>
</tr>
<tr>
<td id="L488" class="blob-num js-line-number" data-line-number="488"></td>
<td id="LC488" class="blob-code blob-code-inner js-file-line">nonmax_age_model &lt;- lmer(choseObjectDrop ~ Condition*Scaled.Days.Old + (1|trial) + (1|Subject), data=main.long, family=&quot;binomial&quot;)</td>
</tr>
<tr>
<td id="L489" class="blob-num js-line-number" data-line-number="489"></td>
<td id="LC489" class="blob-code blob-code-inner js-file-line">#Compare to a model without conditionxage interaction, and with same random effects structure as above</td>
</tr>
<tr>
<td id="L490" class="blob-num js-line-number" data-line-number="490"></td>
<td id="LC490" class="blob-code blob-code-inner js-file-line">no_age &lt;- lmer(choseObjectDrop ~ Condition+Scaled.Days.Old + (1|trial) + (1|Subject), data=main.long, family=&quot;binomial&quot;)</td>
</tr>
<tr>
<td id="L491" class="blob-num js-line-number" data-line-number="491"></td>
<td id="LC491" class="blob-code blob-code-inner js-file-line">anova(nonmax_age_model, no_age)</td>
</tr>
<tr>
<td id="L492" class="blob-num js-line-number" data-line-number="492"></td>
<td id="LC492" class="blob-code blob-code-inner js-file-line">#Clearer to understand: just run correctness age model instead?</td>
</tr>
<tr>
<td id="L493" class="blob-num js-line-number" data-line-number="493"></td>
<td id="LC493" class="blob-code blob-code-inner js-file-line">#Answer #2 yes there is an effect of age!</td>
</tr>
<tr>
<td id="L494" class="blob-num js-line-number" data-line-number="494"></td>
<td id="LC494" class="blob-code blob-code-inner js-file-line">#Question 3 What if we consider only older kids? 4yos and up? (Justification - see conttable analyses)</td>
</tr>
<tr>
<td id="L495" class="blob-num js-line-number" data-line-number="495"></td>
<td id="LC495" class="blob-code blob-code-inner js-file-line">older.long &lt;- main.long[main.long$Age.Years &gt; 4,]</td>
</tr>
<tr>
<td id="L496" class="blob-num js-line-number" data-line-number="496"></td>
<td id="LC496" class="blob-code blob-code-inner js-file-line"># Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects</td>
</tr>
<tr>
<td id="L497" class="blob-num js-line-number" data-line-number="497"></td>
<td id="LC497" class="blob-code blob-code-inner js-file-line">full_maximal_model_older &lt;- lmer(choseObjectDrop ~ Condition + (Condition|trial) + (1|Subject), data=older.long, family=&quot;binomial&quot;)</td>
</tr>
<tr>
<td id="L498" class="blob-num js-line-number" data-line-number="498"></td>
<td id="LC498" class="blob-code blob-code-inner js-file-line">#compare to model w/o fixed effect</td>
</tr>
<tr>
<td id="L499" class="blob-num js-line-number" data-line-number="499"></td>
<td id="LC499" class="blob-code blob-code-inner js-file-line">no_fixed_older &lt;- lmer(choseObjectDrop ~ 1 + (Condition|trial) + (1|Subject), data=older.long, family=&quot;binomial&quot;)</td>
</tr>
<tr>
<td id="L500" class="blob-num js-line-number" data-line-number="500"></td>
<td id="LC500" class="blob-code blob-code-inner js-file-line">anova(full_maximal_model_older, no_fixed_older)</td>
</tr>
<tr>
<td id="L501" class="blob-num js-line-number" data-line-number="501"></td>
<td id="LC501" class="blob-code blob-code-inner js-file-line">#Answer #3 yup</td>
</tr>
<tr>
<td id="L502" class="blob-num js-line-number" data-line-number="502"></td>
<td id="LC502" class="blob-code blob-code-inner js-file-line">#Question #4 Can the littles do it at all? Here we just want to ask if the choices are on average different from 50% (Remember that &#39;conditions&#39; here are just two kinds of true/false!)</td>
</tr>
<tr>
<td id="L503" class="blob-num js-line-number" data-line-number="503"></td>
<td id="LC503" class="blob-code blob-code-inner js-file-line">#(MK goes away and decides the most reasonable way to do this...)</td>
</tr>
<tr>
<td id="L504" class="blob-num js-line-number" data-line-number="504"></td>
<td id="LC504" class="blob-code blob-code-inner js-file-line">#TO INCLUDE: Fisher tests of correctness levels of 3s and 4s in the 2 different experiments. Do 4yos answers informativity qs look like 4yso answering correctness qs?</td>
</tr>
<tr>
<td id="L505" class="blob-num js-line-number" data-line-number="505"></td>
<td id="LC505" class="blob-code blob-code-inner js-file-line">######Graphs</td>
</tr>
<tr>
<td id="L506" class="blob-num js-line-number" data-line-number="506"></td>
<td id="LC506" class="blob-code blob-code-inner js-file-line">#Make a pretty dot graph I hope?</td>
</tr>
<tr>
<td id="L507" class="blob-num js-line-number" data-line-number="507"></td>
<td id="LC507" class="blob-code blob-code-inner js-file-line">Scores &lt;- aggregate(main.long$pragChoice, list(main.long$Subject), sum)</td>
</tr>
<tr>
<td id="L508" class="blob-num js-line-number" data-line-number="508"></td>
<td id="LC508" class="blob-code blob-code-inner js-file-line">names(Scores) &lt;- c(&quot;Subject&quot;,&quot;Score&quot;)</td>
</tr>
<tr>
<td id="L509" class="blob-num js-line-number" data-line-number="509"></td>
<td id="LC509" class="blob-code blob-code-inner js-file-line">Ages &lt;- main.long[ !duplicated(main.long$Subject), c(&quot;Subject&quot;,&quot;Days.Old&quot;)]</td>
</tr>
<tr>
<td id="L510" class="blob-num js-line-number" data-line-number="510"></td>
<td id="LC510" class="blob-code blob-code-inner js-file-line">foo &lt;- merge(Scores,Ages)</td>
</tr>
<tr>
<td id="L511" class="blob-num js-line-number" data-line-number="511"></td>
<td id="LC511" class="blob-code blob-code-inner js-file-line">foo$JitScore &lt;- jitter(foo$Score)</td>
</tr>
<tr>
<td id="L512" class="blob-num js-line-number" data-line-number="512"></td>
<td id="LC512" class="blob-code blob-code-inner js-file-line">plot( foo$Days.Old, foo$JitScore)</td>
</tr>
</table>
</div>
</div>
<a href="#jump-to-line" rel="facebox[.linejump]" data-hotkey="l" style="display:none">Jump to Line</a>
<div id="jump-to-line" style="display:none">
<!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="" class="js-jump-to-line-form" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /></div>
<input class="linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" aria-label="Jump to line" autofocus>
<button type="submit" class="btn">Go</button>
</form></div>
</div>
<div class="modal-backdrop"></div>
</div>
</div>
</div>
</div>
<div class="container">
<div class="site-footer" role="contentinfo">
<ul class="site-footer-links right">
<li><a href="https://status.github.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
<li><a href="https://developer.github.com" data-ga-click="Footer, go to api, text:api">API</a></li>
<li><a href="https://training.github.com" data-ga-click="Footer, go to training, text:training">Training</a></li>
<li><a href="https://shop.github.com" data-ga-click="Footer, go to shop, text:shop">Shop</a></li>
<li><a href="https://github.com/blog" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
<li><a href="https://github.com/about" data-ga-click="Footer, go to about, text:about">About</a></li>
<li><a href="https://github.com/pricing" data-ga-click="Footer, go to pricing, text:pricing">Pricing</a></li>
</ul>
<a href="https://github.com" aria-label="Homepage">
<span aria-hidden="true" class="mega-octicon octicon-mark-github" title="GitHub "></span>
</a>
<ul class="site-footer-links">
<li>&copy; 2016 <span title="0.12949s from github-fe120-cp1-prd.iad.github.net">GitHub</span>, Inc.</li>
<li><a href="https://github.com/site/terms" data-ga-click="Footer, go to terms, text:terms">Terms</a></li>
<li><a href="https://github.com/site/privacy" data-ga-click="Footer, go to privacy, text:privacy">Privacy</a></li>
<li><a href="https://github.com/security" data-ga-click="Footer, go to security, text:security">Security</a></li>
<li><a href="https://github.com/contact" data-ga-click="Footer, go to contact, text:contact">Contact</a></li>
<li><a href="https://help.github.com" data-ga-click="Footer, go to help, text:help">Help</a></li>
</ul>
</div>
</div>
<div id="ajax-error-message" class="flash flash-error">
<span aria-hidden="true" class="octicon octicon-alert"></span>
<button type="button" class="flash-close js-flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
<span aria-hidden="true" class="octicon octicon-x"></span>
</button>
Something went wrong with that request. Please try again.
</div>
<script crossorigin="anonymous" integrity="sha256-KJVHXHFPE3kLY+Y2tTiaaRiiYCWcWyKhWs9e8mvW7wk=" src="https://assets-cdn.github.com/assets/frameworks-2895475c714f13790b63e636b5389a6918a260259c5b22a15acf5ef26bd6ef09.js"></script>
<script async="async" crossorigin="anonymous" integrity="sha256-YToJrIXHxcorOt857cJVmMCsBnJsbqokExLUSkwArEY=" src="https://assets-cdn.github.com/assets/github-613a09ac85c7c5ca2b3adf39edc25598c0ac06726c6eaa241312d44a4c00ac46.js"></script>
<div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner hidden">
<span aria-hidden="true" class="octicon octicon-alert"></span>
<span class="signed-in-tab-flash">You signed in with another tab or window. <a href="">Reload</a> to refresh your session.</span>
<span class="signed-out-tab-flash">You signed out in another tab or window. <a href="">Reload</a> to refresh your session.</span>
</div>
<div class="facebox" id="facebox" style="display:none;">
<div class="facebox-popup">
<div class="facebox-content" role="dialog" aria-labelledby="facebox-header" aria-describedby="facebox-description">
</div>
<button type="button" class="facebox-close js-facebox-close" aria-label="Close modal">
<span aria-hidden="true" class="octicon octicon-x"></span>
</button>
</div>
</div>
</body>
</html>
setwd("~/Dropbox/_Projects/SubDrop/SubDrop Repo/Kid Choice Experiments")
#Analysis of the SubjectDrop study!
#setwd(mydir)
#Reading in all libraries that we (might) use
library(irr)
library(stringr)
library(languageR)
library(lme4)
library(multcomp)
library(binom)
library(dplyr)
library(lsr)
mean.na.rm <- function(x) { mean(x,na.rm=T) }
sum.na.rm <- function(x) { sum(x,na.rm=T) }
stderr <- function(x) sqrt(var(x)/length(x))
#Get directory of this file
directory = getwd()
#Initialize dataset
subtable = data.frame(NULL)
#Load csv with Alldata into variable
subtable = read.csv(paste0(directory, "/SubDrop_Data.csv"), header = TRUE, stringsAsFactors = FALSE)
#Fix some badly formatted columns
subtable$Kid.Response.A...Prag.Choice. <- as.character (subtable$Kid.Response.A...Prag.Choice.)
subtable$Kid.Response.B...Prag.Choice. <- as.character (subtable$Kid.Response.B...Prag.Choice.)
subtable$Gender <- subtable$Gender..Guessed.from.Name.Appearance.
subtable[is.na(subtable)] <- 0
#Fix age calculations!
subtable$Age.Years <- as.numeric(as.character(subtable$Age.Years))
subtable$Days.Old <- as.numeric(as.character(subtable$Days.Old))
####################################
#Pick subset of data to analyze
#Drop non-included kids!
#Right here would be the place to print a table of exclusion reasons.
#New - chose stricter inclusion criteria.., following new paradigm rules (= inconsistent implementation in 1st run)
subtable <- subtable[subtable$Final.Include == 1,]
#Choose ParentSecret and ParentSecretControl study versions
subtable <- subtable[subtable$Experiment == "ParentSecret" | subtable$Experiment == "ParentSecretControl" | subtable$Experiment == "ParentSecretControl2" ,]
#############################################
# Recode condition variables
#SD: 'subject drop' is the 'correct answer', other name for this condition is 'two fruits'
#OD: aka 'two animals'
#Note- we tried 2-trial and 4-trial versions of the task.  With within-subj 4-trial version, we saw big carryover effects. So, analyze just 1st 2 trials
#from all versions togther.
subtable$oldCond <- subtable$Condition
subtable[subtable$Condition == "SDOD",]$Condition <- "SD"
subtable[subtable$Condition == "SDSD",]$Condition <- "SD"
subtable[subtable$Condition == "ODSD",]$Condition <- "OD"
subtable[subtable$Condition == "ODOD",]$Condition <- "OD"
## Code Correctness!  For main experiment, correctness = chose the pragmatic one; For cont, correctness = chose the correct one! (this is the same! wrong answers differ though)
subtable$isPragChoiceA <- "NA"
subtable[subtable$Condition == "SD" & subtable$Kid.Response.A...Prag.Choice. == "eat orange",]$isPragChoiceA <- 1
subtable[subtable$Condition == "OD" & subtable$Kid.Response.A...Prag.Choice. == "monkey eat",]$isPragChoiceA <- 1
subtable[subtable$Condition == "SD" & subtable$Kid.Response.A...Prag.Choice. == "monkey eat",]$isPragChoiceA <- 0
subtable[subtable$Condition == "OD" & subtable$Kid.Response.A...Prag.Choice. == "eat orange",]$isPragChoiceA <- 0
subtable[subtable$Condition == "SD" & subtable$Kid.Response.A...Prag.Choice. == "eat banana",]$isPragChoiceA <- 0
subtable[subtable$Condition == "OD" & subtable$Kid.Response.A...Prag.Choice. == "duck eat",]$isPragChoiceA <- 0
subtable$isPragChoiceB <- "NA"
subtable[subtable$Condition == "SD" & subtable$Kid.Response.B...Prag.Choice. == "pet dog",]$isPragChoiceB <- 1
subtable[subtable$Condition == "OD" & subtable$Kid.Response.B...Prag.Choice. == "girl pet",]$isPragChoiceB <- 1
subtable[subtable$Condition == "SD" & subtable$Kid.Response.B...Prag.Choice. == "girl pet",]$isPragChoiceB <- 0
subtable[subtable$Condition == "OD" & subtable$Kid.Response.B...Prag.Choice. == "pet dog",]$isPragChoiceB <- 0
subtable[subtable$Condition == "SD" & subtable$Kid.Response.B...Prag.Choice. == "pet cat",]$isPragChoiceB <- 0
subtable[subtable$Condition == "SD" & subtable$Kid.Response.B...Prag.Choice. == "pet kitty",]$isPragChoiceB <- 0 #lexical alternative!
subtable[subtable$Condition == "OD" & subtable$Kid.Response.B...Prag.Choice. == "boy pet",]$isPragChoiceB <- 0
#A few kis didn't answer on one trial and will need to be manually dropped
subtable <- subtable[subtable$isPragChoiceA != "NA",]
subtable <- subtable[subtable$isPragChoiceB != "NA",]
subtable$isPragChoiceA <- as.numeric(as.character(subtable$isPragChoiceA))
subtable$isPragChoiceB <- as.numeric(as.character(subtable$isPragChoiceB))
#Express this as # chose 'correct' across experiment
subtable$pragChoiceScore <- subtable$isPragChoiceA + subtable$isPragChoiceB
#...Or as # chose to drop the object
subtable$choseObjectDrop <- subtable$pragChoiceScore
subtable[subtable$Condition == "SD",]$choseObjectDrop <- 2-subtable[subtable$Condition == "SD",]$pragChoiceScore
#Time to split up the kids into Main and Control experiments
maintable <- subtable[subtable$Experiment == "ParentSecret",]
conttable <- subtable[subtable$Experiment == "ParentSecretControl" | subtable$Experiment == "ParentSecretControl2",]
#Toss older/younger accidental participant from conttable, it's just for 3-4yos
conttable <- conttable[conttable$Age.Years < 5,]
conttable <- conttable[conttable$Age.Years > 2,]
maintable
#Look at n kids in sub-experiments (this is good for checking updates on n subjects needed per condition)
#How many kids of each Age, Experiment, Condition?
with(maintable, tapply(as.numeric(as.character(Final.Include)), list(Condition, Age.Years), sum.na.rm), drop=TRUE)
with(conttable, tapply(as.numeric(as.character(Final.Include)), list(Condition, Age.Years), sum.na.rm), drop=TRUE)
14+14+15+11
maintable$Condition <- as.factor(maintable$Condition)
maintable$Subject <- as.factor(maintable$Subject..)
maintable$choseObjectDrop <- as.factor(maintable$choseObjectDrop)
maintable$pragChoice_1 <- maintable$isPragChoiceA
maintable$pragChoice_2 <- maintable$isPragChoiceB
#Get the objective coding scheme back :)
main.long = wideToLong(maintable,within="trial", sep='_')
main.long$choseObjectDrop <- main.long$pragChoice
main.long[main.long$Condition == "SD",]$choseObjectDrop <- 1-main.long[main.long$Condition == "SD",]$pragChoice
conttable$Condition <- as.factor(conttable$Condition)
conttable$Subject <- as.factor(conttable$Subject..)
conttable$choseObjectDrop <- as.factor(conttable$choseObjectDrop)
conttable$pragChoice_1 <- conttable$isPragChoiceA
conttable$pragChoice_2 <- conttable$isPragChoiceB
#Get the objective coding scheme back :)
cont.long = wideToLong(conttable,within="trial", sep='_')
cont.long$choseObjectDrop <- cont.long$pragChoice
cont.long[cont.long$Condition == "SD",]$choseObjectDrop <- 1-cont.long[cont.long$Condition == "SD",]$pragChoice
#For quick-and-dirty graphs
table(maintable$Condition, maintable$choseObjectDrop)
table(maintable$Age.Years, maintable$pragChoiceScore)
table(conttable$Condition, conttable$pragChoiceScore)
table(conttable$Age.Years, conttable$pragChoiceScore)
####################################
###
#Question #1 - is choice of OD puppet sensitive to condition?
# Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects
full_maximal_model <- lmer(choseObjectDrop ~ Condition + (Condition|trial) + (1|Subject), data=main.long, family="binomial")
#compare to model w/o fixed effect
no_fixed <- lmer(choseObjectDrop ~ 1 + (Condition|trial) + (1|Subject), data=main.long, family="binomial")
anova(full_maximal_model, no_fixed)
#Answer #1 marginal (with all ages included)
###
#Question 2: Does age influence choice patterns?
#Scale age (z score), to avoid convergence problems (this worked on some datasets)
main.long$Scaled.Days.Old <- scale(main.long$Days.Old)
# Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects
full_maximal_age_model <- lmer(choseObjectDrop ~ Condition*Scaled.Days.Old + (Condition|trial) + (1|Subject), data=main.long, family="binomial")
#If that doesn't converge, as it doesn't as of 10/10, remove random effects...
nonmax_age_model <- lmer(choseObjectDrop ~ Condition*Scaled.Days.Old + (1|trial) + (1|Subject), data=main.long, family="binomial")
#Compare to a model without conditionxage interaction, and with same random effects structure as above
no_age <- lmer(choseObjectDrop ~ Condition+Scaled.Days.Old + (1|trial) + (1|Subject), data=main.long, family="binomial")
anova(nonmax_age_model, no_age)
#Clearer to understand: just run correctness age model instead?
#Answer #2 yes there is an effect of age!
#Question 3 What if we consider only older kids? 4yos and up? (Justification - see conttable analyses)
older.long <- main.long[main.long$Age.Years > 4,]
# Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects
full_maximal_model_older <- lmer(choseObjectDrop ~ Condition + (Condition|trial) + (1|Subject), data=older.long, family="binomial")
#compare to model w/o fixed effect
no_fixed_older <- lmer(choseObjectDrop ~ 1 + (Condition|trial) + (1|Subject), data=older.long, family="binomial")
anova(full_maximal_model_older, no_fixed_older)
#Answer #3 yup
#Scale age (z score), to avoid convergence problems (this worked on some datasets)
cont.long$Scaled.Days.Old <- scale(cont.long$Days.Old)
cont.long
cont.long$Condition
# Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects
full_maximal_age_model <- lmer(choseObjectDrop ~ Condition*Scaled.Days.Old + (Condition|trial) + (1|Subject), data=cont.long, family="binomial")
#If that doesn't converge, as it doesn't as of 10/10, remove random effects...
nonmax_age_model <- lmer(choseObjectDrop ~ Condition*Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without conditionxage interaction, and with same random effects structure as above
no_age <- lmer(choseObjectDrop ~ Condition+Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without conditionxage interaction, and with same random effects structure as above - remove due to failed convergence!!!! 7/11
no_age <- lmer(choseObjectDrop ~ Condition+Scaled.Days.Old + (1|Subject), data=cont.long, family="binomial")
anova(nonmax_age_model, no_age)
full_maximal_model <- lmer(choseObjectDrop ~ Condition + (Condition|trial) + (1|Subject), data=cont.long, family="binomial")
#compare to model w/o fixed effect
no_fixed <- lmer(choseObjectDrop ~ 1 + (Condition|trial) + (1|Subject), data=cont.long, family="binomial")
anova(full_maximal_model, no_fixed)
names(cont.long)
table(maintable$Age.Years, maintable$pragChoiceScore)
table(conttable$Age.Years, conttable$pragChoiceScore)
foo = c(9, 13, 5, 7, 8, 13)
dim(foo) = c(3,2)
foo
fisher.test(foo)
foo = c(9, 8, 15, 2, 7, 17)
dim(foo) = c(3,2)
fisher.test(foo)
