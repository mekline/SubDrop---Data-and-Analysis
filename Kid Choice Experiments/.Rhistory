table(threes$pragChoice)
threes <- subset(maintable, Age.Years == 3)
fours <- subset(maintable, Age.Years == 4)
fives <- subset(maintable, Age.Years == 5)
sixes <- subset(maintable, Age.Years == 6)
table(threes$pragChoiceScore)
foo <- c(9,13,5,25,50,25)
dim(foo)<-c(2,3)
foo
dim(foo)<-c(3,2)
foo
fisher.test(foo)
foo <- c(9,13,5,250,500,250)
dim(foo)<-c(3,2)
fisher.test(foo)
help(multinomial.test)
??multinomial.test
library(EMT)
library(EMT)
install.packages("EMT")
library(EMT)
help(multinomial.test)
multinomial.test(table(threes$pragChoiceScore),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(threes$pragChoiceScore)),c(0.25, 0.5, 0.25))
as.vector(table(threes$pragChoiceScore))
multinomial.test(as.vector(table(threes$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fives$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(sixes$pragChoiceScore)),c(0.25, 0.5, 0.25))
names(cont.long)
cont.long$pragChoice
cont.long$pragChoiceScore
cont.long$Subject
main.long$Subject
#Scale age (z score), to avoid convergence problems
cont.long$Scaled.Days.Old <- scale(cont.long$Days.Old)
# Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects
full_maximal_age_model <- lmer(pragChoice ~ Scaled.Days.Old + (Condition|trial) + (1|Subject), data=cont.long, family="binomial")
#Didn't converge, remove random fx
nomax_cont_age_model <- lmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
nomax_cont_age_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without conditionxage interaction, and with same random effects structure as above
no_age <- lmer(choseObjectDrop ~ 1 + (1|trial) + (1|Subject), data=cont.long, family="binomial")
nomax_cont_age_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without conditionxage interaction, and with same random effects structure as above
no_age_cont <- lmer(choseObjectDrop ~ 1 + (1|trial) + (1|Subject), data=cont.long, family="binomial")
anova(nonmax_cont_age_model, no_age_cont)
# Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects
full_maximal_age_model <- lmer(pragChoice ~ Scaled.Days.Old + (Condition|trial) + (1|Subject), data=cont.long, family="binomial")
#Didn't converge, remove random fx
nomax_cont_age_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without conditionxage interaction, and with same random effects structure as above
no_age_cont <- lmer(choseObjectDrop ~ 1 + (1|trial) + (1|Subject), data=cont.long, family="binomial")
anova(nomax_cont_age_model, no_age_cont)
full_maximal_age_model <- glmer(pragChoice ~ Scaled.Days.Old + (Condition|trial) + (1|Subject), data=cont.long, family="binomial")
#Didn't converge, remove random fx
nomax_cont_age_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without conditionxage interaction, and with same random effects structure as above
no_age_cont <- glmer(choseObjectDrop ~ 1 + (1|trial) + (1|Subject), data=cont.long, family="binomial")
anova(nomax_cont_age_model, no_age_cont)
threes <- subset(conttable, Age.Years == 3)
fours <- subset(conttable, Age.Years == 4)
multinomial.test(as.vector(table(threes$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours$pragChoiceScore)),c(0.25, 0.5, 0.25))
table(threes$pragChoiceScore)
threefour.long <- rbind(main.long, cont.long)
main.long$Task <- 'main'
cont.long$Task <- 'cont'
threefour.long <- subset(rbind(main.long, cont.long), Age.Years < 5)
names(threefour)
threefour.long
full_max_three_model <- glmer(pragChoice ~ Task*Scaled.Days.Old + (Task|trial) + (1|Subject), data=main.long, family="binomial")
full_max_three_model <- glmer(pragChoice ~ Task*Scaled.Days.Old + (Task|trial) + (1|Subject), data=threefour.long, family="binomial")
nomax_three_model <- glmer(pragChoice ~ Task*Scaled.Days.Old + (1|trial) + (1|Subject), data=threefour.long, family="binomial")
noeff_three_model <- glmer(pragChoice ~ Task+Scaled.Days.Old + (1|trial) + (1|Subject), data=threefour.long, family="binomial")
anova(full_max_three_model,noeff_three_model)
full_max_cont_model <- gglmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without age interaction, and with same random effects structure as above
no_age_cont_model <- gglmer(pragChoice ~ 1 + (1|trial) + (1|Subject), data=cont.long, family="binomial")
anova(full_max_cont_age_model, no_age_cont_model)
# Logistic Regression model.
full_max_cont_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without age interaction, and with same random effects structure as above
no_age_cont_model <- glmer(pragChoice ~ 1 + (1|trial) + (1|Subject), data=cont.long, family="binomial")
anova(full_max_cont_age_model, no_age_cont_model)
# Logistic Regression model.
full_max_cont_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without age interaction, and with same random effects structure as above
no_age_cont_model <- glmer(pragChoice ~ 1 + (1|trial) + (1|Subject), data=cont.long, family="binomial")
anova(full_max_cont_model, no_age_cont_model)
#Translation for the paper: for each year bin, did they tend to choose the 'correct' pragmatic choice?
threes <- subset(conttable, Age.Years == 3)
fours <- subset(conttable, Age.Years == 4)
multinomial.test(as.vector(table(threes$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours$pragChoiceScore)),c(0.25, 0.5, 0.25))
#To answer, make a new dataset with both tasks and just the 3-4yos
main.long$Task <- 'main'
cont.long$Task <- 'cont'
threefour.long <- subset(rbind(main.long, cont.long), Age.Years < 5)
full_max_three_model <- glmer(pragChoice ~ Task*Scaled.Days.Old + (Task|trial) + (1|Subject), data=threefour.long, family="binomial")
#Doesn't converge, remove fx
nomax_three_model <- glmer(pragChoice ~ Task*Scaled.Days.Old + (1|trial) + (1|Subject), data=threefour.long, family="binomial")
#Compare to model without interaction
noeff_three_model <- glmer(pragChoice ~ Task+Scaled.Days.Old + (1|trial) + (1|Subject), data=threefour.long, family="binomial")
anova(full_max_three_model,noeff_three_model)
threes <- subset(maintable, Age.Years == 3)
fours <- subset(maintable, Age.Years == 4)
multinomial.test(as.vector(table(threes$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours$pragChoiceScore)),c(0.25, 0.5, 0.25))
threes <- subset(conttable, Age.Years == 3)
fours <- subset(conttable, Age.Years == 4)
multinomial.test(as.vector(table(threes$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours$pragChoiceScore)),c(0.25, 0.5, 0.25))
# Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects
fullmax_age_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=main.long, family="binomial")
#Compare to a model without conditionxage interaction, and with same random effects structure as above
no_age <- glmer(pragChoice ~ 1 + (1|trial) + (1|Subject), data=main.long, family="binomial")
anova(fullmax_age_model, no_age)
main.long$Age.Years
full_max_cont_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without age interaction, and with same random effects structure as above
no_age_cont_model <- glmer(pragChoice ~ 1 + (1|trial) + (1|Subject), data=cont.long, family="binomial")
anova(full_max_cont_model, no_age_cont_model)
#To answer, make a new dataset with both tasks and just the 3-4yos
main.long$Task <- 'main'
cont.long$Task <- 'cont'
threefour.long <- subset(rbind(main.long, cont.long), Age.Years < 5)
full_max_three_model <- glmer(pragChoice ~ Task*Scaled.Days.Old + (Task|trial) + (1|Subject), data=threefour.long, family="binomial")
#Doesn't converge, remove fx
nomax_three_model <- glmer(pragChoice ~ Task*Scaled.Days.Old + (1|trial) + (1|Subject), data=threefour.long, family="binomial")
#Compare to model without interaction
noeff_three_model <- glmer(pragChoice ~ Task+Scaled.Days.Old + (1|trial) + (1|Subject), data=threefour.long, family="binomial")
anova(full_max_three_model,noeff_three_model)
threes <- subset(conttable, Age.Years == 3)
fours <- subset(conttable, Age.Years == 4)
multinomial.test(as.vector(table(threes$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours$pragChoiceScore)),c(0.25, 0.5, 0.25))
fisher.test(as.vector(table(threem$pragChoiceScore)),as.vector(table(threem$pragChoiceScore)))
threem <- subset(maintable, Age.Years == 3)
threec <- subset(conttable, Age.Years == 3)
fisher.test(as.vector(table(threem$pragChoiceScore)),as.vector(table(threem$pragChoiceScore)))
help(fisher.test)
as.vector(table(threem$pragChoiceScore))
as.vector(table(threem$pragChoiceScore))
fisher.test(as.vector(table(threem$pragChoiceScore)),as.vector(table(threec$pragChoiceScore)))
as.vector(table(threem$pragChoiceScore))
as.vector(table(threec$pragChoiceScore))
nrow(conttable)
nrow(maintable)
nrow(subset(maintable, Age.Years < 5))
conttable$Subject
54+59
#And for translation, the fisher test:
threem <- subset(maintable, Age.Years == 3)
threec <- subset(conttable, Age.Years == 3)
fisher.test(as.vector(table(threem$pragChoiceScore)),as.vector(table(threec$pragChoiceScore)))
nrow(subset(maintable, Age.Years < 4))
nrow(subset(conttable, Age.Years < 4))
27+28
as.vector(table(threem$pragChoiceScore))
as.vector(table(threec$pragChoiceScore))
.75 * .75
.25*.25
0.06 * 28
0.56 * 28
.6 *.6
.36 * 28
.4*.4
28 * .16
############
as.vector(table(threec$pragChoiceScore))
sqrt(13)
sqrt(7)
cont.long
subset(cont.long, Age.Years < 4)$pragChoice
mean(subset(cont.long, Age.Years < 4)$pragChoice)
mean(subset(main.long, Age.Years < 4)$pragChoice)
h = 2(arcsin(2))
arcsin
help(arcsin)
??arcsin
??arcsine
h = 2(asin(2))
h = 2*(asin(2))
p1 = mean(subset(cont.long, Age.Years < 4)$pragChoice)
p2 = mean(subset(main.long, Age.Years < 4)$pragChoice)
h = 2*(asin(sqrt(p1)))-2*(asin(sqrt(p2)))
pwr.2p.test(h = h, , sig.level = 0.05, power = 0.8)
library(pwr)
pwr.2p.test(h = h, , sig.level = 0.05, power = 0.8)
multi = c(p1^2, 2*p1(1-p1), (1-p1)^2)
p1 = mean(subset(cont.long, Age.Years < 4)$pragChoice)
multi = c(p1^2, 2*p1(1-p1), (1-p1)^2)
p1 = mean(subset(cont.long, Age.Years < 4)$pragChoice)
multi = c(p1^2, 2*p1*(1-p1), (1-p1)^2)
multi
sum(multi)
multi = c(p1^2, 2*p1*(1-p1), (1-p1)^2)
nullmulti = c(0.25,0.5,0.25)
multi[1]
((multi[1]-nullmulti[1])^2)/nullmulti[1]
w = sqrt(((multi[1]-nullmulti[1])^2)/nullmulti[1] + ((multi[2]-nullmulti[2])^2)/nullmulti[2] + ((multi[3]-nullmulti[3])^2)/nullmulti[3])
w
pwr.chisq.test(w = w, , sig.level = 0.05, power = 0.8)
pwr.chisq.test(w = w,  sig.level = 0.05, power = 0.8)
pwr.chisq.test(w = w,  sig.level = 0.05, power = 0.8, df=2)
p1 = mean(subset(cont.long, Age.Years < 4)$pragChoice)
p2 = mean(subset(main.long, Age.Years < 4)$pragChoice)
p1 = mean(subset(cont.long, Age.Years < 4)$pragChoice)
p2 = mean(subset(main.long, Age.Years < 4)$pragChoice)
multi = c(p1^2, 2*p1*(1-p1), (1-p1)^2)
#nullmulti = c(0.25,0.5,0.25)
nullmulti = c(p2^2, 2*p2*(1-p2), (1-p2)^2)
w = sqrt(((multi[1]-nullmulti[1])^2)/nullmulti[1] + ((multi[2]-nullmulti[2])^2)/nullmulti[2] + ((multi[3]-nullmulti[3])^2)/nullmulti[3])
pwr.chisq.test(w = w,  sig.level = 0.05, power = 0.8, df=2)
as.vector(table(threem$pragChoiceScore))
as.vector(table(threec$pragChoiceScore))
foo = c(9,7,13,8,5,13)
dim(foo) <- c(2,3)
foo
chisq.test(foo)
fisher.test(as.vector(table(threem$pragChoiceScore)),as.vector(table(threec$pragChoiceScore)))
threem <- subset(maintable, Age.Years == 3)
threec <- subset(conttable, Age.Years == 3)
fisher.test(as.vector(table(threem$pragChoiceScore)),as.vector(table(threec$pragChoiceScore)))
as.vector(table(threem$pragChoiceScore))
fisher.test(foo)
chisq.test(foo)
fisher.test(c(9,13,5), c(7,8,13))
threes <- subset(maintable, Age.Years == 3)
fours <- subset(maintable, Age.Years == 4)
fives <- subset(maintable, Age.Years == 5)
sixes <- subset(maintable, Age.Years == 6)
multinomial.test(as.vector(table(threes$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fives$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(sixes$pragChoiceScore)),c(0.25, 0.5, 0.25))
####################################
# Analysis!
###
# EXPERIMENT 2
###
#Question #1 - is choice of OD puppet sensitive to condition? (Figure 6)  ALL AGES, no age factor
# Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects
full_maximal_model <- glmer(choseObjectDrop ~ Condition + (Condition|trial) + (1|Subject), data=main.long, family="binomial")
#compare to model w/o fixed effect
no_fixed <- glmer(choseObjectDrop ~ 1 + (Condition|trial) + (1|Subject), data=main.long, family="binomial")
anova(full_maximal_model, no_fixed)
#Answer #1 marginal (with all ages included)
###
#Question 2: Here we switch to 'pragmatic choice' bc subject & object order of speaking wasn't counterbalanced. Does age influence choice patterns?
#Scale age (z score), to avoid convergence problems
main.long$Scaled.Days.Old <- scale(main.long$Days.Old)
# Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects
fullmax_age_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=main.long, family="binomial")
#Compare to a model without conditionxage interaction, and with same random effects structure as above
no_age <- glmer(pragChoice ~ 1 + (1|trial) + (1|Subject), data=main.long, family="binomial")
anova(fullmax_age_model, no_age)
#Answer #2: Yes!!
#Translation for the paper: for each year bin, did they tend to choose the 'correct' pragmatic choice?
threes <- subset(maintable, Age.Years == 3)
fours <- subset(maintable, Age.Years == 4)
fives <- subset(maintable, Age.Years == 5)
sixes <- subset(maintable, Age.Years == 6)
multinomial.test(as.vector(table(threes$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fives$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(sixes$pragChoiceScore)),c(0.25, 0.5, 0.25))
###
# EXPERIMENT 3 - 'Objective' task control; note that 'pragmatic' choice here actually means *correct* (vs incorrect) choice
# We collapse across Subject/Object question here since, again, no order counterbalancing, so there is just 1 'condition' to examine, age.
#Question 2 (parallel above): Does age influence choice patterns?
#Scale age (z score), to avoid convergence problems
cont.long$Scaled.Days.Old <- scale(cont.long$Days.Old)
#Scale age (z score), to avoid convergence problems
cont.long$Scaled.Days.Old <- scale(cont.long$Days.Old)
# Logistic Regression model.
full_max_cont_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without age interaction, and with same random effects structure as above
no_age_cont_model <- glmer(pragChoice ~ 1 + (1|trial) + (1|Subject), data=cont.long, family="binomial")
anova(full_max_cont_model, no_age_cont_model)
#Answer #2: No signifi
#Translation for the paper: for each year bin, did they tend to choose the 'correct' pragmatic choice? Yes they do!
threes <- subset(conttable, Age.Years == 3)
fours <- subset(conttable, Age.Years == 4)
multinomial.test(as.vector(table(threes$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(threes$pragChoiceScore)),as.vector(table(fours$pragChoiceScore)))
fisher.test(as.vector(table(threes$pragChoiceScore)),as.vector(table(fours$pragChoiceScore)))
rbind(as.vector(table(threes$pragChoiceScore)), as.vector(table(fours$pragChoiceScore)))
#And is there a difference between them, when measured binned?
comp34 <- rbind(as.vector(table(threes$pragChoiceScore)), as.vector(table(fours$pragChoiceScore)))
fisher.test(comp34)
comp34 <- rbind(as.vector(table(threes$pragChoiceScore)),as.vector(table(fours$pragChoiceScore)))
fisher.test(comp34)
We know: 3s and 4s both significantly above chance in cont task, only 4s above change in main; and only main, not cont shows a continuous age effect (tho cont is not crazy far away)
# But are the tasks actually different from one another by age?
#To answer, make a new dataset with both tasks and just the 3-4yos
main.long$Task <- 'main'
cont.long$Task <- 'cont'
threefour.long <- subset(rbind(main.long, cont.long), Age.Years < 5)
full_max_three_model <- glmer(pragChoice ~ Task*Scaled.Days.Old + (Task|trial) + (1|Subject), data=threefour.long, family="binomial")
#Doesn't converge, remove fx
nomax_three_model <- glmer(pragChoice ~ Task*Scaled.Days.Old + (1|trial) + (1|Subject), data=threefour.long, family="binomial")
#Compare to model without interaction
noeff_three_model <- glmer(pragChoice ~ Task+Scaled.Days.Old + (1|trial) + (1|Subject), data=threefour.long, family="binomial")
anova(full_max_three_model,noeff_three_model)
#And for translation, the fisher test:
comp34 <- rbind(as.vector(table(threes$pragChoiceScore)),as.vector(table(fours$pragChoiceScore)))
fisher.test(comp34)
threes_main <- subset(maintable, Age.Years == 3)
threes_main <- subset(maintable, Age.Years == 3)
comp33 <- rbind(as.vector(table(threes$pragChoiceScore)),as.vector(table(threes_main$pragChoiceScore)))
fisher.test(comp33)
comp34 <- rbind(as.vector(table(threes$pragChoiceScore)),as.vector(table(fours$pragChoiceScore)))
fisher.test(comp34)
threes_main <- subset(maintable, Age.Years == 3)
fours_main <- subset(maintable, Age.Years == 4)
mcomp34 <- rbind(as.vector(table(threes_main$pragChoiceScore)),as.vector(table(fours_main$pragChoiceScore)))
fisher.test(mcomp34)
fisher.test(comp34)
fisher.test(mcomp34) #p = 0.06
multi = c(p1^2, 2*p1*(1-p1), (1-p1)^2)
nullmulti = c(0.25,0.5,0.25)
w = sqrt(((multi[1]-nullmulti[1])^2)/nullmulti[1] + ((multi[2]-nullmulti[2])^2)/nullmulti[2] + ((multi[3]-nullmulti[3])^2)/nullmulti[3])
pwr.chisq.test(w = w,  sig.level = 0.05, power = 0.8, df=2)
pwr.chisq.test(w = w,  sig.level = 0.05, power = 0.8, df=1)
pwr.chisq.test(w = w,  sig.level = 0.05, power = 0.8, df=3)
pwr.chisq.test(w = w,  sig.level = 0.05, power = 0.8, df=2)
setwd("~/Dropbox/_Projects/SubDrop/SubDrop Repo/Kid Choice Experiments")
#Analysis of the SubjectDrop kid studies!
#setwd(mydir)
#Reading in all libraries that we (might) use
library(irr)
library(stringr)
library(languageR)
library(lme4)
library(multcomp)
library(binom)
library(dplyr)
library(lsr)
library(EMT)
mean.na.rm <- function(x) { mean(x,na.rm=T) }
sum.na.rm <- function(x) { sum(x,na.rm=T) }
stderr <- function(x) sqrt(var(x)/length(x))
#Get directory of this file
directory = getwd()
#Initialize dataset
subtable = data.frame(NULL)
#Load csv with Alldata into variable
subtable = read.csv(paste0(directory, "/SubDrop_Data.csv"), header = TRUE, stringsAsFactors = FALSE)
#Fix some badly formatted columns
subtable$Kid.Response.A...Prag.Choice. <- as.character (subtable$Kid.Response.A...Prag.Choice.)
subtable$Kid.Response.B...Prag.Choice. <- as.character (subtable$Kid.Response.B...Prag.Choice.)
subtable$Gender <- subtable$Gender..Guessed.from.Name.Appearance.
subtable[is.na(subtable)] <- 0
#Fix age calculations!
subtable$Age.Years <- as.numeric(as.character(subtable$Age.Years))
subtable$Days.Old <- as.numeric(as.character(subtable$Days.Old))
####################################
#Pick subset of data to analyze (experiment, kids included)
#Choose ParentSecret and ParentSecretControl study versions
subtable <- subtable[subtable$Experiment == "ParentSecret" | subtable$Experiment == "ParentSecretControl" | subtable$Experiment == "ParentSecretControl2" ,]
subtable[subtable$Experiment ==  "ParentSecretControl2",]$Experiment <- "ParentSecretControl"
#chose stricter inclusion criteria.., following new paradigm rules dropped <- subtable[subtable$Final.Include == 0,]
subtable <- subtable[subtable$Final.Include == 1,]
#who & why excluded from analysis?
table(dropped$Final.Reason, dropped$Experiment)
#Note: Bilingual, Developmental delay, no consent, too young/wrong age are outside the intended sample, tested bc it's the museum
#ExpErrorJ: A series of major implementation flaws were discovered after several months (:( ) - 1st RA implementation was very inconsistently implemented so a large # odf participants must be excluded)
#############################################
# Recode condition variables
#SD: 'subject drop' is the 'correct answer', other name for this condition is 'two fruits'
#OD: aka 'two animals'
#Note- we tried 2-trial and 4-trial versions of the task.  With within-subj 4-trial version, we saw big carryover effects. So, analyze just 1st 2 trials
#from all versions togther.
subtable$oldCond <- subtable$Condition
subtable[subtable$Condition == "SDOD",]$Condition <- "SD"
subtable[subtable$Condition == "SDSD",]$Condition <- "SD"
subtable[subtable$Condition == "ODSD",]$Condition <- "OD"
subtable[subtable$Condition == "ODOD",]$Condition <- "OD"
## Code Correctness!  For main experiment, correctness = chose the pragmatic one; For cont, correctness = chose the correct one! (this is the same! wrong answers differ though)
subtable$isPragChoiceA <- "NA"
subtable[subtable$Condition == "SD" & subtable$Kid.Response.A...Prag.Choice. == "eat orange",]$isPragChoiceA <- 1
subtable[subtable$Condition == "OD" & subtable$Kid.Response.A...Prag.Choice. == "monkey eat",]$isPragChoiceA <- 1
subtable[subtable$Condition == "SD" & subtable$Kid.Response.A...Prag.Choice. == "monkey eat",]$isPragChoiceA <- 0
subtable[subtable$Condition == "OD" & subtable$Kid.Response.A...Prag.Choice. == "eat orange",]$isPragChoiceA <- 0
subtable[subtable$Condition == "SD" & subtable$Kid.Response.A...Prag.Choice. == "eat banana",]$isPragChoiceA <- 0
subtable[subtable$Condition == "OD" & subtable$Kid.Response.A...Prag.Choice. == "duck eat",]$isPragChoiceA <- 0
subtable$isPragChoiceB <- "NA"
subtable[subtable$Condition == "SD" & subtable$Kid.Response.B...Prag.Choice. == "pet dog",]$isPragChoiceB <- 1
subtable[subtable$Condition == "OD" & subtable$Kid.Response.B...Prag.Choice. == "girl pet",]$isPragChoiceB <- 1
subtable[subtable$Condition == "SD" & subtable$Kid.Response.B...Prag.Choice. == "girl pet",]$isPragChoiceB <- 0
subtable[subtable$Condition == "OD" & subtable$Kid.Response.B...Prag.Choice. == "pet dog",]$isPragChoiceB <- 0
subtable[subtable$Condition == "SD" & subtable$Kid.Response.B...Prag.Choice. == "pet cat",]$isPragChoiceB <- 0
subtable[subtable$Condition == "SD" & subtable$Kid.Response.B...Prag.Choice. == "pet kitty",]$isPragChoiceB <- 0 #lexical alternative!
subtable[subtable$Condition == "OD" & subtable$Kid.Response.B...Prag.Choice. == "boy pet",]$isPragChoiceB <- 0
#A few kis didn't answer on one trial and will need to be manually dropped
subtable <- subtable[subtable$isPragChoiceA != "NA",]
subtable <- subtable[subtable$isPragChoiceB != "NA",]
subtable$isPragChoiceA <- as.numeric(as.character(subtable$isPragChoiceA))
subtable$isPragChoiceB <- as.numeric(as.character(subtable$isPragChoiceB))
#Express this as # chose 'correct' across experiment
subtable$pragChoiceScore <- subtable$isPragChoiceA + subtable$isPragChoiceB
#...Or as # chose to drop the object
subtable$choseObjectDrop <- subtable$pragChoiceScore
subtable[subtable$Condition == "SD",]$choseObjectDrop <- 2-subtable[subtable$Condition == "SD",]$pragChoiceScore
####################################
#Descriptive stats for graphing (Developmental, small sample, so we'll present hist. of kids choosing each asnwer, rather than proportion scores)
#Time to split up the kids into Main and Control experiments
maintable <- subtable[subtable$Experiment == "ParentSecret",]
conttable <- subtable[subtable$Experiment == "ParentSecretControl" | subtable$Experiment == "ParentSecretControl2",]
#Toss older/younger accidental participant from conttable, it's just for 3-4yos
conttable <- conttable[conttable$Age.Years < 5,]
conttable <- conttable[conttable$Age.Years > 2,]
#Look at n kids in sub-experiments (this is good for checking updates on n subjects needed per condition)
#How many kids of each Age, Experiment, Condition?
with(maintable, tapply(as.numeric(as.character(Final.Include)), list(Condition, Age.Years), sum.na.rm), drop=TRUE)
with(conttable, tapply(as.numeric(as.character(Final.Include)), list(Condition, Age.Years), sum.na.rm), drop=TRUE)
#Make sure factors are coded correctly, and melt the dataset for logistic analyses
maintable$Condition <- as.factor(maintable$Condition)
maintable$Subject <- as.factor(maintable$Subject..)
maintable$choseObjectDrop <- as.factor(maintable$choseObjectDrop)
maintable$pragChoice_1 <- maintable$isPragChoiceA
maintable$pragChoice_2 <- maintable$isPragChoiceB
#Get the objective coding scheme back :)
main.long = wideToLong(maintable,within="trial", sep='_')
main.long$choseObjectDrop <- main.long$pragChoice
main.long[main.long$Condition == "SD",]$choseObjectDrop <- 1-main.long[main.long$Condition == "SD",]$pragChoice
conttable$Condition <- as.factor(conttable$Condition)
conttable$Subject <- as.factor(conttable$Subject..)
conttable$choseObjectDrop <- as.factor(conttable$choseObjectDrop)
conttable$pragChoice_1 <- conttable$isPragChoiceA
conttable$pragChoice_2 <- conttable$isPragChoiceB
#Get the objective coding scheme back :)
cont.long = wideToLong(conttable,within="trial", sep='_')
cont.long$choseObjectDrop <- cont.long$pragChoice
cont.long[cont.long$Condition == "SD",]$choseObjectDrop <- 1-cont.long[cont.long$Condition == "SD",]$pragChoice
#For quick-and-dirty graphs
table(maintable$Condition, maintable$choseObjectDrop)
table(maintable$Age.Years, maintable$pragChoiceScore)
table(conttable$Condition, conttable$pragChoiceScore)
table(conttable$Age.Years, conttable$pragChoiceScore)
####################################
# Analysis!
###
# EXPERIMENT 2
###
#Question #1 - is choice of OD puppet sensitive to condition? (Figure 6)  ALL AGES, no age factor
# Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects
full_maximal_model <- glmer(choseObjectDrop ~ Condition + (Condition|trial) + (1|Subject), data=main.long, family="binomial")
#compare to model w/o fixed effect
no_fixed <- glmer(choseObjectDrop ~ 1 + (Condition|trial) + (1|Subject), data=main.long, family="binomial")
anova(full_maximal_model, no_fixed)
#Answer #1 marginal (with all ages included)
###
#Question 2: Here we switch to 'pragmatic choice' bc subject & object order of speaking wasn't counterbalanced. Does age influence choice patterns?
#Scale age (z score), to avoid convergence problems
main.long$Scaled.Days.Old <- scale(main.long$Days.Old)
# Logistic Regression model.  No (Condition|Subject) random effect because condition was varied between subjects
fullmax_age_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=main.long, family="binomial")
#Compare to a model without conditionxage interaction, and with same random effects structure as above
no_age <- glmer(pragChoice ~ 1 + (1|trial) + (1|Subject), data=main.long, family="binomial")
anova(fullmax_age_model, no_age)
#Answer #2: Yes!!
#Translation for the paper: for each year bin, did they tend to choose the 'correct' pragmatic choice?
threes_m <- subset(maintable, Age.Years == 3)
fours_m <- subset(maintable, Age.Years == 4)
fives <- subset(maintable, Age.Years == 5)
sixes <- subset(maintable, Age.Years == 6)
multinomial.test(as.vector(table(threes_m$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours_m$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fives$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(sixes$pragChoiceScore)),c(0.25, 0.5, 0.25))
###
###
# EXPERIMENT 3 - 'Objective' task control; note that 'pragmatic' choice here actually means *correct* (vs incorrect) choice
# We collapse across Subject/Object question here since, again, no order counterbalancing, so there is just 1 'condition' to examine, age.
#Question 1 (skip, no interpretable condition difference here)
#Question 2 (parallel above): Does age influence choice patterns?
#Scale age (z score), to avoid convergence problems
cont.long$Scaled.Days.Old <- scale(cont.long$Days.Old)
# Logistic Regression model.
full_max_cont_model <- glmer(pragChoice ~ Scaled.Days.Old + (1|trial) + (1|Subject), data=cont.long, family="binomial")
#Compare to a model without age interaction, and with same random effects structure as above
no_age_cont_model <- glmer(pragChoice ~ 1 + (1|trial) + (1|Subject), data=cont.long, family="binomial")
anova(full_max_cont_model, no_age_cont_model)
#Answer #2:We measure no significant difference!(but it wouldn't be crazy if there was one, p = 0.1)
#Translation for the paper: for each year bin, did they tend to choose the 'correct' pragmatic choice? Yes they do, but the 4s are numerically better
threes_c <- subset(conttable, Age.Years == 3)
fours_c <- subset(conttable, Age.Years == 4)
multinomial.test(as.vector(table(threes_c$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours_c$pragChoiceScore)),c(0.25, 0.5, 0.25))
#To answer, make a new dataset with both tasks and just the 3-4yos
main.long$Task <- 'main'
cont.long$Task <- 'cont'
threefour.long <- subset(rbind(main.long, cont.long), Age.Years < 5)
full_max_three_model <- glmer(pragChoice ~ Task*Scaled.Days.Old + (Task|trial) + (1|Subject), data=threefour.long, family="binomial")
#Doesn't converge, remove fx
nomax_three_model <- glmer(pragChoice ~ Task*Scaled.Days.Old + (1|trial) + (1|Subject), data=threefour.long, family="binomial")
#Compare to model without interaction
noeff_three_model <- glmer(pragChoice ~ Task+Scaled.Days.Old + (1|trial) + (1|Subject), data=threefour.long, family="binomial")
anova(nomax_three_model,noeff_three_model) # comes out p=.27
#Confusing! No task/age interaction. Trying the binned version:
threetab <- rbind(as.vector(table(threes_c$pragChoiceScore)), as.vector(table(threes_m$pragChoiceScore)))
fourtab <- rbind(as.vector(table(fours_c$pragChoiceScore)), as.vector(table(fours_m$pragChoiceScore)))
multinomial.test(as.vector(table(threes_c$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours_c$pragChoiceScore)),c(0.25, 0.5, 0.25))
threes_c <- subset(conttable, Age.Years == 3)
fours_c <- subset(conttable, Age.Years == 4)
multinomial.test(as.vector(table(threes_c$pragChoiceScore)),c(0.25, 0.5, 0.25))
multinomial.test(as.vector(table(fours_c$pragChoiceScore)),c(0.25, 0.5, 0.25))
